[ ] cleanup code and refactor, with the help of pylint
[ ] make encoding per document, not a global one.
